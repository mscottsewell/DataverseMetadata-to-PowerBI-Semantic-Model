<?xml version="1.0"?>
<package>
	<metadata>
    <id>DataverseToPowerBI.XrmToolBox</id>
    <version>1.2026.4.16</version>
    <title>Dataverse to Power BI Semantic Model</title>
    <authors>Scott Sewell</authors>
    <owners>mScottSewell</owners>
    <requireLicenseAcceptance>false</requireLicenseAcceptance>
    <license type="expression">MIT</license>
    <description>Extract Dataverse metadata and generate Power BI TMDL/PBIP semantic models with automatic table relationships, calendar tables, and incremental change detection.</description>
    <summary>XrmToolBox plugin for generating Power BI semantic models from Dataverse metadata</summary>
    <releaseNotes>
- **TMDL Preview Feature** — Replaced "View SQL" with "Preview TMDL" showing the exact TMDL statements that will be written to the semantic model
  - Displays sorted preview list with automatic categorization: Expressions → Date Table → Fact Table → Dimensions (alphabetically)
  - **Connection Mode Awareness**: 
    - TDS mode: Shows "DataverseURL" parameter table as Expression type
    - FabricLink mode: Shows both "Expressions" (FabricSQLEndpoint + FabricLakehouse parameters) and "DataverseURL" table
  - **Date Table Integration**: Date table entry appears automatically if configured, positioned after Expressions and before data tables; omitted if date table is not configured
  - **Preview-to-Build Consistency**: Output is identical to actual build — uses the real `SemanticModelBuilder.GenerateTmdlPreview()` API instead of divergent inline generation
  - Visual distinction by entry type: italic blue text for Config/Date entries, bold for Fact table, normal for Dimensions
  - Type labels in second column: "Config", "Date", "Fact", "Dimension"
  - **Export Capabilities**:
    - Copy selected TMDL to clipboard with one click
    - Save individual `.tmdl` file with sanitized filename based on entry name
    - Save All button exports all entries as separate `.tmdl` files to chosen folder
  - Full TMDL content with UTF-8 encoding (no BOM): complete table declarations, column definitions with data types, measures, hierarchies, and M partition expressions

- **Display Name Aliases in SQL** — Columns can now use display names as SQL aliases (`AS [Display Name]`) for human-readable column names in the semantic model
  - **Per-model toggle**: "Use Display Name Aliases in SQL" checkbox in Semantic Model Settings (enabled by default for new models)
  - **Per-attribute override**: Double-click the Display Name column in the attributes list to set a custom alias for any column; setting it back to the original removes the override
  - **Auto-override for primary name attributes**: Primary name columns automatically get "{Table Name} {Column Name}" aliases to avoid duplicates across tables (e.g., "Account Name" instead of "Name")
  - **Duplicate detection**: Conflicting display name aliases are highlighted in light red in the attributes list; build and preview are blocked with a descriptive error listing all conflicts
  - **Override indicators**: Overridden display names show an asterisk (*) suffix in the attributes list
  - **Full TMDL integration**: Aliases are applied consistently across `GenerateTableTmdl`, `GenerateMQuery`, and `GenerateExpectedColumns` for all column types (regular, lookup, choice/boolean, multi-select, datetime-wrapped)
  - **Settings persistence**: Overrides are saved per-table and restored when loading a semantic model
    </releaseNotes>
    <tags>XrmToolBox PowerBI Dataverse TMDL PBIP SemanticModel</tags>
    <projectUrl>https://github.com/mscottsewell/DataverseMetadata-to-PowerBI-Semantic-Model</projectUrl>
    <iconUrl>https://raw.githubusercontent.com/mscottsewell/DataverseMetadata-to-PowerBI-Semantic-Model/main/Images/DataverseToPowerBI_128.png</iconUrl>
    <dependencies>
        <group targetFramework="net48">
            <dependency id="XrmToolBox" version="[1.2025.10.74,)" />
        </group>
    </dependencies>
  </metadata>
  <files>
    <file src="DataverseToPowerBI.XrmToolBox\bin\Release\DataverseToPowerBI.XrmToolBox.dll" target="lib\net48\Plugins\" />
    <file src="DataverseToPowerBI.Core\bin\Release\net48\DataverseToPowerBI.Core.dll" target="lib\net48\Plugins\" />
    <file src="DataverseToPowerBI.XrmToolBox\Assets\PBIP_DefaultTemplate\**\*.*" target="lib\net48\Plugins\DataverseToPowerBI\PBIP_DefaultTemplate\" />
    <file src="DataverseToPowerBI.XrmToolBox\Assets\Icons\**\*.*" target="lib\net48\Plugins\DataverseToPowerBI\Icons\" />
    <file src="Images\DataverseToPowerBI_80.png" target="icon.png" />
    <file src="README.md" target="README.md" />
    <file src="LICENSE" target="LICENSE" />
  </files>
</package>   
